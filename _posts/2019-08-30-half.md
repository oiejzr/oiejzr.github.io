---
layout: post
title: '洛谷2019PJ #2 二分与贪心'
subtitle: '假设你是诸葛孔明，那自然是聪明绝顶。有人心里悄悄想了一个数，这个数在[1,1024]范围内。你可以猜一个数，此人会马上告诉你，你猜的数是大了、小了还是正好。'
date: 2019-08-30
categories: OI
cover: 'http://on2171g4d.bkt.clouddn.com/jekyll-theme-h2o-postcover.jpg'
tags: Luogu.2019.PJ
---

## 2.1 二分
### Q2.1.a 【引入】陈年老梗
假设你是诸葛孔明，那自然是聪明绝顶。有人心里悄悄想了一个数，这个数在[1,1024]范围内。你可以猜一个数，此人会马上告诉你，你猜的数是大了、小了还是正好。

你能提供一个方案，以尽量少的猜测次数，保证获取正确答案吗？
### 2.1.1 二分的性质
作用：快速查找有序的大量数据中的一个元素位置

时间复杂度：$O(nlogn)$

注意：没有单调性（无序）的情况下不可二分！

基本模型整数二分法：

[0 0 0  ... 0 0 0 1 1 1 1 1 1 1 1 1 ...]

有一个序列，前一段全是0，后一段全是1.

要快速找到第一个1在哪.

在一个排好序的数组中，可以通过二分查找的方法知道
- 某个数在不在数组中
- 比x大的最小值
- 比x小的最大值

二分原理：
![nQpLYF.png](https://s2.ax1x.com/2019/09/06/nQpLYF.png)

二分答案：
![nQpxyR.png](https://s2.ax1x.com/2019/09/06/nQpxyR.png)
### Q2.1.b 【例题】跳石头
这项比赛将在一条笔直的河道中进行，河道中分布着一些巨大岩石。组委会已经选择好了两块岩石作为比赛起点和终点。在起点和终点之间，有 N块岩石（不含起点和终点的岩石）。在比赛过程中，选手们将从起点出发，每一步跳向相邻的岩石，直至到达终点。

为了提高比赛难度，组委会计划移走一些岩石，使得选手们在比赛过程中的最短跳跃距离尽可能长。由于预算限制，组委会至多从起点和终点之间移走 M块岩石（不能移走起点和终点的岩石）。
### Q2.1.b 分析
从[0,position.end]中二分查找答案

查找时，若查找值最短距离x=30，如图
![nQ9pex.png](https://s2.ax1x.com/2019/09/06/nQ9pex.png)
如果移走的石头数量k>m，输出x，结束程序

∵$x$与难度单调递增

∴容易证明，$k_{min}$时，$x_{max}$
### 2.1.2 可行的偷懒
如果懒得去确定写法，建议：

在r-l >= 5时，二分

区间长度降到5以下之后，逐个枚举这些数，找到答案。
### 2.1.3 实数范围内的二分
已知函数单调上升，求函数零点。

【例题】求解一元三次方程
有形如：$f(x)=ax^3+bx^2+cx^1+dx^0=0$这样的一个一元三次方程。给出该方程中各项的系数($a,b,c,d$均为实数)，并约定该方程存在三个不同实根(根的范围在$-100$至$100$之间)，且根与根之差的绝对值$≥1$。要求由小到大依次在同一行输出这三个实根(根与根之间留有空格)，并精确到小数点后$2$位。

提示：记方程$f(x)=0$，若存在$2$个数$x1$和$x2$，且$x1<x2，f(x1)×f(x2)<0$
，则在$(x1,x2)$之间一定有一个根。


【分析】将根的范围分为多个区间 

由上文根与根之差的绝对值$≥1$可以知道一个区间内必定只有一个根

可在满足条件$f(x1)×f(x2)$的情况下在区间内枚举答案.
### Q2.1.c 【例题】某题Orz [提高+/省选-]
给定序列a，长度n=10w.

有m(m<n)个排序指令：

- l r opt 将某个区间从小到大或从大到小排序

给定x，问：在执行完所有的排序操作之后，a[x]是多少。
### Q2.1.c 【分析】
在给定的长度[0,n]之间二分答案k（时间复杂度：$O(logn)$）

记bool f(k)为最后的a[x]是否≥k

k:0 1 2 3      …     n

f:1 1 1 … 1 1 0 0 … 0

子任务：找到最大的f(k)=1的k

如何快速执行排序操作？

注意到性质：目前的序列是01序列。


对01序列的某个区间升序排序：把0扔到左边，把1扔到右边
- 要查找出区间内1的个数，记为cnt		区间求和
- 把前cnt个赋值为0			        区间赋值
- 把后面的赋值为1
利用线段树，上述的三个操作都可以$O(logn)$完成

总时间复杂度$O(nlogn^2)$，满足要求
### 2.1.4 三分
二分用于求单调函数的零点。

三分用于求单峰函数的峰值。


已知函数单峰，且峰值在$[l,r]$范围内。
如何找到这个峰值？

在$f(x)$上取点$(a,f(a))$与$(b,f(b))$

若$f(a)>f(b)$ 可以排除$[b,r]$		若$f(a)<f(b)$ 可以排除$[l,a]$

![nQ9KTf.png](https://s2.ax1x.com/2019/09/06/nQ9KTf.png)
## 2.2 差分与前缀和
### Q2.1.a 【例题】区间加
给定一个序列$a$(初值全为$0$)。有很多次操作，每个操作形如：$A l r k$

将$𝑎_([l,r])$每个值加上$k$.

最后输出整个数组。复杂度要求$O(n)$.允许离线.
### Q2.1.a 分析
我们很自然地想到：

如果我们知道每一个元素比前一个元素大多少，我们显然可以推出整个序列。

e.g. 已知$𝑎_1=2$. $𝑎_2$比$𝑎_1$大$3$, $𝑎_3$比$𝑎_2$小$4$.

那么可以推出：$𝑎_2=𝑎_1+3=5$ , $𝑎_3=𝑎_2−4=1$.

要知道差值，应该发现：

区间加$[l,r]$，实际上是发生了这两件事：

- $a[l]$比前一个元素多了k;
- $a[r+1]$比前一个元素少了k.

我们用数组p表示刚刚的差值，$p[i]=a[i]-a[i-1]$.

那么：区间加$[𝑙,𝑟]$，可以化为这两个操作：

p[l]+=k;

p[r+1]-=k;       

因此，一次区间加只修改这两个元素;

最后利用p数组求出a数组，即为答案。
## 2.3 贪心
### Q2.3.a 【引入】恰烂钱
设我们要用100、50、20、10、5、1面值的人民币凑出w元。

求所用钞票的数量最少的方案。
### 2.3.1 贪心的性质
贪心的本质：面对一个局面，判断之后立刻作决策。

某学语言：计算局部最优解并合并成全局最优解

### Q2.3.b 【例题】独木桥
战争已经进入到紧要时间。你是运输小队长，正在率领运输部队向前线运送物资。运输任务像做题一样的无聊。你希望找些刺激，于是命令你的士兵们到前方的一座独木桥上欣赏风景，而你留在桥下欣赏士兵们。士兵们十分愤怒，因为这座独木桥十分狭窄，只能容纳1个人通过。假如有2个人相向而行在桥上相遇，那么他们2个人将无妨绕过对方，只能有1个人回头下桥，让另一个人先通过。但是，可以有多个人同时呆在同一个位置。

突然，你收到从指挥部发来的信息，敌军的轰炸机正朝着你所在的独木桥飞来！为了安全，你的部队必须撤下独木桥。独木桥的长度为L，士兵们只能呆在坐标为整数的地方。所有士兵的速度都为1，但一个士兵某一时刻来到了坐标为0或L+1位置，他就离开了独木桥。

每个士兵都有一个初始面对的方向，他们会以匀速朝着这个方向行走，中途不会自己改变方向。但是，如果两个士兵面对面相遇，他们无法彼此通过对方，于是就分别转身，继续行走。转身不需要任何的时间。

由于先前的愤怒，你已不能控制你的士兵。甚至，你连每个士兵初始面对的方向都不知道。因此，你想要知道你的部队最少需要多少时间就可能全部撤离独木桥。另外，总部也在安排阻拦敌人的进攻，因此你还需要知道你的部队最多需要多少时间才能全部撤离独木桥。

**输入格式：**

第一行：一个整数，表示独木桥的长度。桥上的坐标为1…L

第二行：一个整数N，表示初始时留在桥上的士兵数目

第三行：有N个整数，分别表示每个士兵的初始坐标。

**输出格式：**

只有一行，输出2个整数，分别表示部队撤离独木桥的最小时间和最大时间。2个整数由一个空格符分开。

### Q2.3.b 【分析】
发现问题：可以视为任何士兵均相同，**一个士兵可以从头走到尾**

简化问题：那么我们就可以把所有士兵分开。首先，我们把他们一个个读进去。然后，对于每一个士兵，他有向左和向右两种选择。设士兵在位置p，如果向左，需要p时间单位；向右，需要L-p+1个。分别取max和min，更新答案即可。

### 2.3.2 基本不等式
$∵(a+b)^2≥0$

$∴a^2-2ab+b^2≥0$

$∴a^2+b^2≥2ab$

$∴a+b≥2\sqrt{ab}$

并且仅当$a=b$时取等号
### Q2.3.c 【例题】复杂度问题
假设𝑛给定。现在有个参数𝑇由你钦定，然后：

操作A  耗时𝑇

操作B	耗时𝑛/𝑇

应该如何钦定𝑇，来最小化平均耗时？

### Q2.3.c 【分析】
即取得最小值$\cfrac{T+\cfrac{n}{T}}{2}$，由基本不等式知
$$\frac{T+\cfrac{n}{T}}{2}\geq\sqrt{T\frac{n}{T}}\geq\sqrt{n}$$

最小值为$\sqrt{n}$
### Q2.3.d 【例题】某Orz水题
要你钦定一个长度为𝑛的排列𝑎，使得$1a_1+2a_2+3a_3+...+na_n$最小/最大。

### Q2.3.d 【分析】
最大：$a=1,2,3...$

最小：$a=n,n-1,...$

可以推出排序不等式： a与b的正序和 ≥ 乱序和 ≥ 逆序和
证明：假设某个乱序方案得到了最大值。去证“可以通过交换两个数，来得到更大的值”，从而推翻假设，得证原命题。

### Q2.3.e 【例题】数论证明
求证：$a^3+b^3+c^3≥a^2b+b^2c+c^2a$，其中a，b，c均是正数
### Q2.3.e 【分析】
记序列$X=a,b,c$

记序列$Y=a2,b2,c2$

得知①式为正序，②式为乱序

$∴①≥②$